<!DOCTYPE HTML>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="gray-bg">
  <div class="container-div">
    <div class="row">
      <div class="col-sm-12 select-info">
        <form id="schedule-form">
          <div class="select-list">
            <ul>
              <li>
                <span class="select-item-name">投放名称：</span>
                <input type="text" name="scheduleName"/>
              </li>
              <li>
                <span class="select-item-name">投放用户：</span>
                <input type="text" name="releaser"/>
              </li>
              <li>
                <span class="select-item-name">广告商户：</span>
                <input type="text" name="advertiser"/>
              </li>
              <li>
                <span class="select-item-name">推广用户：</span>
                <input type="text" name="promotioner"/>
              </li>
              <li>
                <span class="select-item-name">投放状态：</span>
                <select name="status" th:with="type=${@dict.getType('schedule_status')}">
                <option value="">所有</option>
                <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"></option>
              </select>
              </li>
              <li class="select-time">
                <label class="select-item-name">投放时间： </label>
                <input type="text" class="time-input" id="startTime" placeholder="开始时间" name="params[beginTime]"/>
                <span>-</span>
                <input type="text" class="time-input" id="endTime" placeholder="结束时间" name="params[endTime]"/>
              </li>
              <li class="select-btns">
                <a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i class="fa fa-search"></i>&nbsp;搜索
                </a>
                <a class="btn btn-success btn-rounded btn-sm" onclick="$.table.exportExcel()">
                  <i class="fa fa-download"></i>&nbsp;导出
                </a>
                <a class="btn btn-success btn-rounded btn-sm" onclick="materialUpload()"><i class="fa fa-download"></i>&nbsp;素材上传
                </a>
                <a class="btn btn-success btn-rounded btn-sm" onclick="commitSchedule()"><i class="fa fa-download"></i>&nbsp;预约
                </a>
                <a class="btn btn-success btn-rounded btn-sm" onclick="releaseSchedule()"><i class="fa fa-download"></i>&nbsp;审核
                </a>
                <a class="btn btn-success btn-rounded btn-sm" onclick="releaseSchedule()"><i class="fa fa-download"></i>&nbsp;发布
                </a>
              </li>
            </ul>
          </div>
        </form>
      </div>
      <div class="btn-group hidden-xs" id="toolbar" role="group">
        <a class="btn btn-outline btn-success btn-rounded" onclick="$.operate.add()" shiro:hasPermission="advertise:adSchedule:add">
          <i class="fa fa-plus"></i> 新增
        </a>
        <a class="btn btn-outline btn-danger btn-rounded" onclick="$.operate.removeAll()" shiro:hasPermission="advertise:adSchedule:remove">
          <i class="fa fa-trash-o"></i> 删除
        </a>
      </div>

      <div class="col-sm-12 select-table table-striped">
        <table id="bootstrap-table" data-mobile-responsive="true" class="layui-table" lay-even="" lay-skin="row"></table>
      </div>
    </div>
    <div th:include="include :: footer"></div>
    <script th:inline="javascript">
      var editFlag = [[${@permission.hasPermi('advertise:adSchedule:edit')}]];
      var removeFlag = [[${@permission.hasPermi('advertise:adSchedule:remove')}]];
      var prefix = ctx + 'advertise/adSchedule';

      $(function () {
        var options = {
          url      : prefix + '/list',
          createUrl: prefix + '/add',
          updateUrl: prefix + '/edit/{id}',
          removeUrl: prefix + '/remove',
          modalName: '广告投放',
          columns  : [
            {
              checkbox: true
            },
            {
              field: 'adScheduleId',
              title: ''
            },
            {
              field: 'scheduleName',
              title: '投放名称'
            },
            {
              field: 'releaseType',
              title: '投放方式'
            },
            {
              field: 'releasePosition',
              title: '投放位置'
            },
            {
              field: 'status',
              title: '投放状态'
            },
            {
              field: 'totalPay',
              title: '总价'
            },
            {
              field: 'prepay',
              title: '押金'
            },
            {
              field: 'releaseTermNum',
              title: '投放终端数'
            },
            {
              field: 'releaseNote',
              title: '投放备注'
            },
            {
              field: 'createBy',
              title: '创建用户'
            },
            {
              field: 'createTime',
              title: '创建时间'
            },
            {
              title    : '操作',
              align    : 'center',
              formatter: function (value, row, index) {
                var actions = [];
                actions.push('<a class="btn btn-success btn-xs ' + editFlag + '" href="#" onclick="$.operate.edit(\'' +
                  row.adScheduleId + '\')"><i class="fa fa-edit"></i>编辑</a> ');
                actions.push(
                  '<a class="btn btn-danger btn-xs ' + removeFlag + '" href="#" onclick="$.operate.remove(\'' +
                  row.adScheduleId + '\')"><i class="fa fa-remove"></i>删除</a>');
                return actions.join('');
              }
            }]
        };
        $.table.init(options);
      });

      //素材上传弹窗函数
      function materialUpload () {
        var url = ctx + 'advertise/adSchedule/materialUpload';
        $.modal.open('素材上传', url);
      }
    </script>
</body>
</html>